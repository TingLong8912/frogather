{"ast":null,"code":"var _jsxFileName = \"/Users/yantinglong/Documents/project/frogather/src/components/Map/Map.js\";\nimport { useEffect, useContext, useCallback } from \"react\";\nimport MapContext from \"hook/MapContext\";\nimport * as ol from \"ol\";\nimport { Icon, Style } from \"ol/style\";\nimport PinRed from \"assets/pin_red.svg\";\nimport PinGreen from \"assets/pin_green.svg\";\nconst selectStyle = new Style({\n  image: new Icon({\n    anchor: [0.5, 16],\n    anchorXUnits: 'fraction',\n    anchorYUnits: 'pixels',\n    src: PinRed,\n    width: 50,\n    height: 50\n  })\n});\nconst notselectStyle = new Style({\n  image: new Icon({\n    anchor: [0.5, 16],\n    anchorXUnits: 'fraction',\n    anchorYUnits: 'pixels',\n    src: PinGreen,\n    width: 40,\n    height: 40\n  })\n});\nconst Map = ({\n  children\n}) => {\n  const {\n    map,\n    mapRef,\n    zoom,\n    setZoom,\n    center,\n    setCenter,\n    setMap\n  } = useContext(MapContext);\n\n  // on component mount\n  useEffect(() => {\n    let options = {\n      view: new ol.View({\n        zoom,\n        center\n      }),\n      layers: [],\n      controls: [],\n      overlays: []\n    };\n    let mapObject = new ol.Map(options);\n    mapObject.setTarget(mapRef.current);\n    mapObject.on('click', evt => handleSingleClick(mapObject, evt));\n    mapObject.on('pointermove', evt => handleHover(mapObject, evt));\n    setMap(mapObject);\n    return () => {\n      mapObject.setTarget(undefined);\n    };\n  }, []);\n\n  // zoom change handler\n  useEffect(() => {\n    if (!map) return;\n    map.getView().setZoom(zoom);\n  }, [zoom]);\n\n  // center change handler\n  useEffect(() => {\n    if (!map) return;\n    map.getView().setCenter(center);\n  }, [center]);\n\n  /* MAP CLICK EVENT */\n  const handleClickScroll = id => {\n    var element = document.getElementById(id);\n    if (element) {\n      var container = document.getElementById(\"list\");\n      // element.style.background = \"gray\";\n      container.scrollTo({\n        top: element.offsetTop,\n        behavior: 'smooth'\n      });\n    }\n  };\n  const handleSingleClick = useCallback((mapObject, evt) => {\n    const {\n      coordinate,\n      pixel\n    } = evt;\n    const feature = mapObject.forEachFeatureAtPixel(pixel, feature => {\n      return feature;\n    }, {\n      layerFilter: layer => {\n        return layer.get('name') === 'recordLayer';\n      }\n    });\n    if (feature) {\n      var id = feature.getProperties()[\"id\"];\n      handleClickScroll(id);\n      setCenter(coordinate);\n      setZoom(11);\n    }\n  }, []);\n\n  /* MAP HOVER EVENT */\n  const handleHover = useCallback((mapObject, evt) => {\n    const {\n      pixel\n    } = evt;\n    mapObject.getLayers().forEach(function (el) {\n      if (el.get('name') === 'recordLayer') {\n        el.getSource().forEachFeature(feature => {\n          feature.setStyle(notselectStyle);\n        });\n      }\n    });\n    var feature = mapObject.forEachFeatureAtPixel(pixel, feature => {\n      return feature;\n    }, {\n      layerFilter: layer => {\n        return layer.get('name') === 'recordLayer';\n      }\n    });\n    if (feature) feature.setStyle(selectStyle);\n  }, []);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    ref: mapRef,\n    className: \"map\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 3\n    }\n  }, children);\n};\nexport { Map };","map":{"version":3,"names":["useEffect","useContext","useCallback","MapContext","ol","Icon","Style","PinRed","PinGreen","selectStyle","image","anchor","anchorXUnits","anchorYUnits","src","width","height","notselectStyle","Map","children","map","mapRef","zoom","setZoom","center","setCenter","setMap","options","view","View","layers","controls","overlays","mapObject","setTarget","current","on","evt","handleSingleClick","handleHover","undefined","getView","handleClickScroll","id","element","document","getElementById","container","scrollTo","top","offsetTop","behavior","coordinate","pixel","feature","forEachFeatureAtPixel","layerFilter","layer","get","getProperties","getLayers","forEach","el","getSource","forEachFeature","setStyle","React","createElement","ref","className","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber"],"sources":["/Users/yantinglong/Documents/project/frogather/src/components/Map/Map.js"],"sourcesContent":["import { useEffect, useContext, useCallback } from \"react\";\nimport MapContext from \"hook/MapContext\";\nimport * as ol from \"ol\";\nimport { Icon, Style } from \"ol/style\";\nimport PinRed from 'assets/pin_red.svg';\nimport PinGreen from 'assets/pin_green.svg';\n\nconst selectStyle = new Style({\n\timage: new Icon({\n\t\tanchor: [0.5, 16],\n\t\tanchorXUnits: 'fraction',\n\t\tanchorYUnits: 'pixels',\n\t\tsrc: PinRed,\n\t\twidth: 50,\n\t\theight: 50,\n\t}),\n});\n\nconst notselectStyle = new Style({\n\timage: new Icon({\n\t\tanchor: [0.5, 16],\n\t\tanchorXUnits: 'fraction',\n\t\tanchorYUnits: 'pixels',\n\t\tsrc: PinGreen,\n\t\twidth: 40,\n\t\theight: 40,\n\t}),\n});\n\nconst Map = ({ children }) => {\n\tconst { map, mapRef, zoom, setZoom, center, setCenter, setMap } = useContext(MapContext);\n\n\t// on component mount\n\tuseEffect(() => {\n\t\tlet options = { \n\t\t\tview: new ol.View({ zoom, center }),\n\t\t\tlayers: [],\n\t\t\tcontrols: [],\n\t\t\toverlays: [],\n\t\t};\n\t\t\n\t\tlet mapObject = new ol.Map(options);\n\n\t\tmapObject.setTarget(mapRef.current);\n\t\tmapObject.on('click', (evt) => handleSingleClick(mapObject,  evt));\n\t\tmapObject.on('pointermove', (evt) => handleHover(mapObject, evt))\n\t\tsetMap(mapObject);\n\n\t\treturn () => {\n\t\t\tmapObject.setTarget(undefined);\n\t\t}\n\t}, []);\n\n\t// zoom change handler\n\tuseEffect(() => {\n\t\tif (!map) return;\n\t\tmap.getView().setZoom(zoom);\n\t}, [zoom]);\n\n\t// center change handler\n\tuseEffect(() => {\n\t\tif (!map) return;\n\t\tmap.getView().setCenter(center);\n\t}, [center]);\n\n\t/* MAP CLICK EVENT */\n\tconst handleClickScroll = (id) => {\n    var element = document.getElementById(id);\n    if (element) {\n\t\t\tvar container = document.getElementById(\"list\");\n\t\t\t// element.style.background = \"gray\";\n    \tcontainer.scrollTo({ top: element.offsetTop, behavior: 'smooth' });\n    }\n  };\n\n\tconst handleSingleClick = useCallback((mapObject, evt) => {\n\t\tconst { coordinate, pixel } = evt;\n\t\tconst feature = mapObject.forEachFeatureAtPixel(pixel, (feature) => {\n\t\t\treturn feature;\n\t\t}, \n\t\t{ layerFilter: (layer) => {\n\t\t\treturn (layer.get('name') === 'recordLayer') ;\n\t\t}});\n\t\tif (feature) {\n\t\t\tvar id = feature.getProperties()[\"id\"];\n\t\t\thandleClickScroll(id);\n\t\t\tsetCenter(coordinate);\n\t\t\tsetZoom(11);\n\t\t}\n  }, []);\n\n\t/* MAP HOVER EVENT */\n\tconst handleHover = useCallback((mapObject,  evt) => {\n\t\tconst { pixel } = evt;\n\n\t\tmapObject.getLayers().forEach(function(el) {\n\t\t\tif (el.get('name') === 'recordLayer') {\n\t\t\t\tel.getSource().forEachFeature( (feature) => {\n\t\t\t\t\tfeature.setStyle(notselectStyle);\n\t\t\t\t});\n\t\t\t}\n\t\t})\n\t\tvar feature = mapObject.forEachFeatureAtPixel(pixel, (feature) => {\t\t\t\n\t\t\treturn feature;\n\t\t}, {\n\t\t\tlayerFilter: (layer) => {\n\t\t\t\treturn (layer.get('name') === 'recordLayer') ;\n\t\t\t}\n\t\t});\t\n\n\t\tif (feature) feature.setStyle(selectStyle);\n\t}, []);\n\n\n\treturn (\n\t\t<div ref={mapRef} className=\"map\" >\n\t\t\t{children}\n\t\t</div>\n\t)\n}\n\nexport { Map };"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}