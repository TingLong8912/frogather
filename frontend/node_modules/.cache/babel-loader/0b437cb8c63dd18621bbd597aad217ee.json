{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n    };\n    return extendStatics(d, b);\n  };\n  return function (d, b) {\n    if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n    extendStatics(d, b);\n    function __() {\n      this.constructor = d;\n    }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n/**\n * @module ol/renderer/canvas/VectorTileLayer\n */\nimport CanvasBuilderGroup from '../../render/canvas/BuilderGroup.js';\nimport CanvasExecutorGroup from '../../render/canvas/ExecutorGroup.js';\nimport CanvasTileLayerRenderer from './TileLayer.js';\nimport TileState from '../../TileState.js';\nimport VectorTileRenderType from '../../layer/VectorTileRenderType.js';\nimport ViewHint from '../../ViewHint.js';\nimport { HIT_DETECT_RESOLUTION, createHitDetectionImageData, hitDetect } from '../../render/canvas/hitdetect.js';\nimport { apply as applyTransform, create as createTransform, multiply, reset as resetTransform, scale, scale as scaleTransform, translate as translateTransform } from '../../transform.js';\nimport { boundingExtent, buffer, containsExtent, equals, getIntersection, getTopLeft, intersects } from '../../extent.js';\nimport { getSquaredTolerance as getSquaredRenderTolerance, renderFeature } from '../vector.js';\nimport { getUid } from '../../util.js';\nimport { toSize } from '../../size.js';\nimport { wrapX } from '../../coordinate.js';\n/**\n * @type {!Object<string, Array<import(\"../../render/canvas.js\").BuilderType>>}\n */\nvar IMAGE_REPLAYS = {\n  'image': ['Polygon', 'Circle', 'LineString', 'Image', 'Text'],\n  'hybrid': ['Polygon', 'LineString'],\n  'vector': []\n};\n/**\n * @type {!Object<string, Array<import(\"../../render/canvas.js\").BuilderType>>}\n */\nvar VECTOR_REPLAYS = {\n  'hybrid': ['Image', 'Text', 'Default'],\n  'vector': ['Polygon', 'Circle', 'LineString', 'Image', 'Text', 'Default']\n};\n/**\n * @classdesc\n * Canvas renderer for vector tile layers.\n * @api\n * @extends {CanvasTileLayerRenderer<import(\"../../layer/VectorTile.js\").default>}\n */\nvar CanvasVectorTileLayerRenderer = /** @class */function (_super) {\n  __extends(CanvasVectorTileLayerRenderer, _super);\n  /**\n   * @param {import(\"../../layer/VectorTile.js\").default} layer VectorTile layer.\n   */\n  function CanvasVectorTileLayerRenderer(layer) {\n    var _this = _super.call(this, layer) || this;\n    /** @private */\n    _this.boundHandleStyleImageChange_ = _this.handleStyleImageChange_.bind(_this);\n    /**\n     * @private\n     * @type {number}\n     */\n    _this.renderedLayerRevision_;\n    /**\n     * @private\n     * @type {import(\"../../transform\").Transform}\n     */\n    _this.renderedPixelToCoordinateTransform_ = null;\n    /**\n     * @private\n     * @type {number}\n     */\n    _this.renderedRotation_;\n    /**\n     * @private\n     * @type {import(\"../../transform.js\").Transform}\n     */\n    _this.tmpTransform_ = createTransform();\n    return _this;\n  }\n  /**\n   * @param {import(\"../../VectorRenderTile.js\").default} tile Tile.\n   * @param {number} pixelRatio Pixel ratio.\n   * @param {import(\"../../proj/Projection\").default} projection Projection.\n   * @return {boolean|undefined} Tile needs to be rendered.\n   */\n  CanvasVectorTileLayerRenderer.prototype.prepareTile = function (tile, pixelRatio, projection) {\n    var render;\n    var state = tile.getState();\n    if (state === TileState.LOADED || state === TileState.ERROR) {\n      this.updateExecutorGroup_(tile, pixelRatio, projection);\n      if (this.tileImageNeedsRender_(tile)) {\n        render = true;\n      }\n    }\n    return render;\n  };\n  /**\n   * @param {number} z Tile coordinate z.\n   * @param {number} x Tile coordinate x.\n   * @param {number} y Tile coordinate y.\n   * @param {import(\"../../PluggableMap.js\").FrameState} frameState Frame state.\n   * @return {!import(\"../../Tile.js\").default} Tile.\n   */\n  CanvasVectorTileLayerRenderer.prototype.getTile = function (z, x, y, frameState) {\n    var pixelRatio = frameState.pixelRatio;\n    var viewState = frameState.viewState;\n    var resolution = viewState.resolution;\n    var projection = viewState.projection;\n    var layer = this.getLayer();\n    var tile = layer.getSource().getTile(z, x, y, pixelRatio, projection);\n    var viewHints = frameState.viewHints;\n    var hifi = !(viewHints[ViewHint.ANIMATING] || viewHints[ViewHint.INTERACTING]);\n    if (hifi || !tile.wantedResolution) {\n      tile.wantedResolution = resolution;\n    }\n    var render = this.prepareTile(tile, pixelRatio, projection);\n    if (render && (hifi || Date.now() - frameState.time < 8) && layer.getRenderMode() !== VectorTileRenderType.VECTOR) {\n      this.renderTileImage_(tile, frameState);\n    }\n    return _super.prototype.getTile.call(this, z, x, y, frameState);\n  };\n  /**\n   * @param {import(\"../../VectorRenderTile.js\").default} tile Tile.\n   * @return {boolean} Tile is drawable.\n   */\n  CanvasVectorTileLayerRenderer.prototype.isDrawableTile = function (tile) {\n    var layer = this.getLayer();\n    return _super.prototype.isDrawableTile.call(this, tile) && (layer.getRenderMode() === VectorTileRenderType.VECTOR ? getUid(layer) in tile.executorGroups : tile.hasContext(layer));\n  };\n  /**\n   * @inheritDoc\n   */\n  CanvasVectorTileLayerRenderer.prototype.getTileImage = function (tile) {\n    return tile.getImage(this.getLayer());\n  };\n  /**\n   * Determine whether render should be called.\n   * @param {import(\"../../PluggableMap.js\").FrameState} frameState Frame state.\n   * @return {boolean} Layer is ready to be rendered.\n   */\n  CanvasVectorTileLayerRenderer.prototype.prepareFrame = function (frameState) {\n    var layerRevision = this.getLayer().getRevision();\n    if (this.renderedLayerRevision_ !== layerRevision) {\n      this.renderedLayerRevision_ = layerRevision;\n      this.renderedTiles.length = 0;\n    }\n    return _super.prototype.prepareFrame.call(this, frameState);\n  };\n  /**\n   * @param {import(\"../../VectorRenderTile.js\").default} tile Tile.\n   * @param {number} pixelRatio Pixel ratio.\n   * @param {import(\"../../proj/Projection.js\").default} projection Projection.\n   * @private\n   */\n  CanvasVectorTileLayerRenderer.prototype.updateExecutorGroup_ = function (tile, pixelRatio, projection) {\n    var layer = /** @type {import(\"../../layer/VectorTile.js\").default} */this.getLayer();\n    var revision = layer.getRevision();\n    var renderOrder = layer.getRenderOrder() || null;\n    var resolution = tile.wantedResolution;\n    var builderState = tile.getReplayState(layer);\n    if (!builderState.dirty && builderState.renderedResolution === resolution && builderState.renderedRevision == revision && builderState.renderedRenderOrder == renderOrder) {\n      return;\n    }\n    var source = layer.getSource();\n    var declutter = layer.getDeclutter();\n    var sourceTileGrid = source.getTileGrid();\n    var tileGrid = source.getTileGridForProjection(projection);\n    var tileExtent = tileGrid.getTileCoordExtent(tile.wrappedTileCoord);\n    var sourceTiles = source.getSourceTiles(pixelRatio, projection, tile);\n    var layerUid = getUid(layer);\n    delete tile.hitDetectionImageData[layerUid];\n    tile.executorGroups[layerUid] = [];\n    if (declutter) {\n      tile.declutterExecutorGroups[layerUid] = [];\n    }\n    builderState.dirty = false;\n    var _loop_1 = function (t, tt) {\n      var sourceTile = sourceTiles[t];\n      if (sourceTile.getState() != TileState.LOADED) {\n        return \"continue\";\n      }\n      var sourceTileCoord = sourceTile.tileCoord;\n      var sourceTileExtent = sourceTileGrid.getTileCoordExtent(sourceTileCoord);\n      var sharedExtent = getIntersection(tileExtent, sourceTileExtent);\n      var builderExtent = buffer(sharedExtent, layer.getRenderBuffer() * resolution, this_1.tmpExtent);\n      var bufferedExtent = equals(sourceTileExtent, sharedExtent) ? null : builderExtent;\n      var builderGroup = new CanvasBuilderGroup(0, builderExtent, resolution, pixelRatio);\n      var declutterBuilderGroup = declutter ? new CanvasBuilderGroup(0, sharedExtent, resolution, pixelRatio) : undefined;\n      var squaredTolerance = getSquaredRenderTolerance(resolution, pixelRatio);\n      /**\n       * @param {import(\"../../Feature.js\").FeatureLike} feature Feature.\n       * @this {CanvasVectorTileLayerRenderer}\n       */\n      var render = function (feature) {\n        var styles;\n        var styleFunction = feature.getStyleFunction() || layer.getStyleFunction();\n        if (styleFunction) {\n          styles = styleFunction(feature, resolution);\n        }\n        if (styles) {\n          var dirty = this.renderFeature(feature, squaredTolerance, styles, builderGroup, declutterBuilderGroup);\n          builderState.dirty = builderState.dirty || dirty;\n        }\n      };\n      var features = sourceTile.getFeatures();\n      if (renderOrder && renderOrder !== builderState.renderedRenderOrder) {\n        features.sort(renderOrder);\n      }\n      for (var i = 0, ii = features.length; i < ii; ++i) {\n        var feature = features[i];\n        if (!bufferedExtent || intersects(bufferedExtent, feature.getGeometry().getExtent())) {\n          render.call(this_1, feature);\n        }\n      }\n      var executorGroupInstructions = builderGroup.finish();\n      // no need to clip when the render tile is covered by a single source tile\n      var replayExtent = layer.getRenderMode() !== VectorTileRenderType.VECTOR && declutter && sourceTiles.length === 1 ? null : sharedExtent;\n      var renderingReplayGroup = new CanvasExecutorGroup(replayExtent, resolution, pixelRatio, source.getOverlaps(), executorGroupInstructions, layer.getRenderBuffer());\n      tile.executorGroups[layerUid].push(renderingReplayGroup);\n      if (declutterBuilderGroup) {\n        var declutterExecutorGroup = new CanvasExecutorGroup(null, resolution, pixelRatio, source.getOverlaps(), declutterBuilderGroup.finish(), layer.getRenderBuffer());\n        tile.declutterExecutorGroups[layerUid].push(declutterExecutorGroup);\n      }\n    };\n    var this_1 = this;\n    for (var t = 0, tt = sourceTiles.length; t < tt; ++t) {\n      _loop_1(t, tt);\n    }\n    builderState.renderedRevision = revision;\n    builderState.renderedRenderOrder = renderOrder;\n    builderState.renderedResolution = resolution;\n  };\n  /**\n   * @param {import(\"../../coordinate.js\").Coordinate} coordinate Coordinate.\n   * @param {import(\"../../PluggableMap.js\").FrameState} frameState Frame state.\n   * @param {number} hitTolerance Hit tolerance in pixels.\n   * @param {import(\"../vector.js\").FeatureCallback<T>} callback Feature callback.\n   * @param {Array<import(\"../Map.js\").HitMatch<T>>} matches The hit detected matches with tolerance.\n   * @return {T|undefined} Callback result.\n   * @template T\n   */\n  CanvasVectorTileLayerRenderer.prototype.forEachFeatureAtCoordinate = function (coordinate, frameState, hitTolerance, callback, matches) {\n    var resolution = frameState.viewState.resolution;\n    var rotation = frameState.viewState.rotation;\n    hitTolerance = hitTolerance == undefined ? 0 : hitTolerance;\n    var layer = this.getLayer();\n    var source = layer.getSource();\n    var tileGrid = source.getTileGridForProjection(frameState.viewState.projection);\n    var hitExtent = boundingExtent([coordinate]);\n    buffer(hitExtent, resolution * hitTolerance, hitExtent);\n    /** @type {!Object<string, import(\"../Map.js\").HitMatch<T>|true>} */\n    var features = {};\n    /**\n     * @param {import(\"../../Feature.js\").FeatureLike} feature Feature.\n     * @param {import(\"../../geom/SimpleGeometry.js\").default} geometry Geometry.\n     * @param {number} distanceSq The squared distance to the click position.\n     * @return {T|undefined} Callback result.\n     */\n    var featureCallback = function (feature, geometry, distanceSq) {\n      var key = feature.getId();\n      if (key === undefined) {\n        key = getUid(feature);\n      }\n      var match = features[key];\n      if (!match) {\n        if (distanceSq === 0) {\n          features[key] = true;\n          return callback(feature, layer, geometry);\n        }\n        matches.push(features[key] = {\n          feature: feature,\n          layer: layer,\n          geometry: geometry,\n          distanceSq: distanceSq,\n          callback: callback\n        });\n      } else if (match !== true && distanceSq < match.distanceSq) {\n        if (distanceSq === 0) {\n          features[key] = true;\n          matches.splice(matches.lastIndexOf(match), 1);\n          return callback(feature, layer, geometry);\n        }\n        match.geometry = geometry;\n        match.distanceSq = distanceSq;\n      }\n      return undefined;\n    };\n    var renderedTiles = /** @type {Array<import(\"../../VectorRenderTile.js\").default>} */this.renderedTiles;\n    var found;\n    var _loop_2 = function (i, ii) {\n      var tile = renderedTiles[i];\n      var tileExtent = tileGrid.getTileCoordExtent(tile.wrappedTileCoord);\n      if (!intersects(tileExtent, hitExtent)) {\n        return \"continue\";\n      }\n      var layerUid = getUid(layer);\n      var executorGroups = [tile.executorGroups[layerUid]];\n      var declutterExecutorGroups = tile.declutterExecutorGroups[layerUid];\n      if (declutterExecutorGroups) {\n        executorGroups.push(declutterExecutorGroups);\n      }\n      executorGroups.some(function (executorGroups) {\n        var declutteredFeatures = executorGroups === declutterExecutorGroups ? frameState.declutterTree.all().map(function (item) {\n          return item.value;\n        }) : null;\n        for (var t = 0, tt = executorGroups.length; t < tt; ++t) {\n          var executorGroup = executorGroups[t];\n          found = executorGroup.forEachFeatureAtCoordinate(coordinate, resolution, rotation, hitTolerance, featureCallback, declutteredFeatures);\n          if (found) {\n            return true;\n          }\n        }\n      });\n    };\n    for (var i = 0, ii = renderedTiles.length; !found && i < ii; ++i) {\n      _loop_2(i, ii);\n    }\n    return found;\n  };\n  /**\n   * Asynchronous layer level hit detection.\n   * @param {import(\"../../pixel.js\").Pixel} pixel Pixel.\n   * @return {Promise<Array<import(\"../../Feature\").default>>} Promise that resolves with an array of features.\n   */\n  CanvasVectorTileLayerRenderer.prototype.getFeatures = function (pixel) {\n    return new Promise(function (resolve, reject) {\n      var layer = /** @type {import(\"../../layer/VectorTile.js\").default} */this.getLayer();\n      var layerUid = getUid(layer);\n      var source = layer.getSource();\n      var projection = this.renderedProjection;\n      var projectionExtent = projection.getExtent();\n      var resolution = this.renderedResolution;\n      var tileGrid = source.getTileGridForProjection(projection);\n      var coordinate = applyTransform(this.renderedPixelToCoordinateTransform_, pixel.slice());\n      var tileCoord = tileGrid.getTileCoordForCoordAndResolution(coordinate, resolution);\n      var tile;\n      for (var i = 0, ii = this.renderedTiles.length; i < ii; ++i) {\n        if (tileCoord.toString() === this.renderedTiles[i].tileCoord.toString()) {\n          tile = this.renderedTiles[i];\n          if (tile.getState() === TileState.LOADED) {\n            var extent_1 = tileGrid.getTileCoordExtent(tile.tileCoord);\n            if (source.getWrapX() && projection.canWrapX() && !containsExtent(projectionExtent, extent_1)) {\n              wrapX(coordinate, projection);\n            }\n            break;\n          }\n          tile = undefined;\n        }\n      }\n      if (!tile || tile.loadingSourceTiles > 0) {\n        resolve([]);\n        return;\n      }\n      var extent = tileGrid.getTileCoordExtent(tile.wrappedTileCoord);\n      var corner = getTopLeft(extent);\n      var tilePixel = [(coordinate[0] - corner[0]) / resolution, (corner[1] - coordinate[1]) / resolution];\n      var features = tile.getSourceTiles().reduce(function (accumulator, sourceTile) {\n        return accumulator.concat(sourceTile.getFeatures());\n      }, []);\n      var hitDetectionImageData = tile.hitDetectionImageData[layerUid];\n      if (!hitDetectionImageData && !this.animatingOrInteracting_) {\n        var tileSize = toSize(tileGrid.getTileSize(tileGrid.getZForResolution(resolution, source.zDirection)));\n        var rotation = this.renderedRotation_;\n        var transforms = [this.getRenderTransform(tileGrid.getTileCoordCenter(tile.wrappedTileCoord), resolution, 0, HIT_DETECT_RESOLUTION, tileSize[0] * HIT_DETECT_RESOLUTION, tileSize[1] * HIT_DETECT_RESOLUTION, 0)];\n        hitDetectionImageData = createHitDetectionImageData(tileSize, transforms, features, layer.getStyleFunction(), tileGrid.getTileCoordExtent(tile.wrappedTileCoord), tile.getReplayState(layer).renderedResolution, rotation);\n        tile.hitDetectionImageData[layerUid] = hitDetectionImageData;\n      }\n      resolve(hitDetect(tilePixel, features, hitDetectionImageData));\n    }.bind(this));\n  };\n  /**\n   * Perform action necessary to get the layer rendered after new fonts have loaded\n   */\n  CanvasVectorTileLayerRenderer.prototype.handleFontsChanged = function () {\n    var layer = this.getLayer();\n    if (layer.getVisible() && this.renderedLayerRevision_ !== undefined) {\n      layer.changed();\n    }\n  };\n  /**\n   * Handle changes in image style state.\n   * @param {import(\"../../events/Event.js\").default} event Image style change event.\n   * @private\n   */\n  CanvasVectorTileLayerRenderer.prototype.handleStyleImageChange_ = function (event) {\n    this.renderIfReadyAndVisible();\n  };\n  /**\n   * Render declutter items for this layer\n   * @param {import(\"../../PluggableMap.js\").FrameState} frameState Frame state.\n   */\n  CanvasVectorTileLayerRenderer.prototype.renderDeclutter = function (frameState) {\n    var context = this.context;\n    var alpha = context.globalAlpha;\n    context.globalAlpha = this.getLayer().getOpacity();\n    var viewHints = frameState.viewHints;\n    var hifi = !(viewHints[ViewHint.ANIMATING] || viewHints[ViewHint.INTERACTING]);\n    var tiles = /** @type {Array<import(\"../../VectorRenderTile.js\").default>} */this.renderedTiles;\n    for (var i = 0, ii = tiles.length; i < ii; ++i) {\n      var tile = tiles[i];\n      var declutterExecutorGroups = tile.declutterExecutorGroups[getUid(this.getLayer())];\n      if (declutterExecutorGroups) {\n        for (var j = declutterExecutorGroups.length - 1; j >= 0; --j) {\n          declutterExecutorGroups[j].execute(this.context, 1, this.getTileRenderTransform(tile, frameState), frameState.viewState.rotation, hifi, undefined, frameState.declutterTree);\n        }\n      }\n    }\n    context.globalAlpha = alpha;\n  };\n  CanvasVectorTileLayerRenderer.prototype.getTileRenderTransform = function (tile, frameState) {\n    var pixelRatio = frameState.pixelRatio;\n    var viewState = frameState.viewState;\n    var center = viewState.center;\n    var resolution = viewState.resolution;\n    var rotation = viewState.rotation;\n    var size = frameState.size;\n    var width = Math.round(size[0] * pixelRatio);\n    var height = Math.round(size[1] * pixelRatio);\n    var source = this.getLayer().getSource();\n    var tileGrid = source.getTileGridForProjection(frameState.viewState.projection);\n    var tileCoord = tile.tileCoord;\n    var tileExtent = tileGrid.getTileCoordExtent(tile.wrappedTileCoord);\n    var worldOffset = tileGrid.getTileCoordExtent(tileCoord, this.tmpExtent)[0] - tileExtent[0];\n    var transform = multiply(scale(this.inversePixelTransform.slice(), 1 / pixelRatio, 1 / pixelRatio), this.getRenderTransform(center, resolution, rotation, pixelRatio, width, height, worldOffset));\n    return transform;\n  };\n  /**\n   * Render the layer.\n   * @param {import(\"../../PluggableMap.js\").FrameState} frameState Frame state.\n   * @param {HTMLElement} target Target that may be used to render content to.\n   * @return {HTMLElement} The rendered element.\n   */\n  CanvasVectorTileLayerRenderer.prototype.renderFrame = function (frameState, target) {\n    var viewHints = frameState.viewHints;\n    var hifi = !(viewHints[ViewHint.ANIMATING] || viewHints[ViewHint.INTERACTING]);\n    _super.prototype.renderFrame.call(this, frameState, target);\n    this.renderedPixelToCoordinateTransform_ = frameState.pixelToCoordinateTransform.slice();\n    this.renderedRotation_ = frameState.viewState.rotation;\n    var layer = /** @type {import(\"../../layer/VectorTile.js\").default} */this.getLayer();\n    var renderMode = layer.getRenderMode();\n    var context = this.context;\n    var alpha = context.globalAlpha;\n    context.globalAlpha = layer.getOpacity();\n    var replayTypes = VECTOR_REPLAYS[renderMode];\n    var viewState = frameState.viewState;\n    var rotation = viewState.rotation;\n    var tileSource = layer.getSource();\n    var tileGrid = tileSource.getTileGridForProjection(viewState.projection);\n    var z = tileGrid.getZForResolution(viewState.resolution, tileSource.zDirection);\n    var tiles = this.renderedTiles;\n    var clips = [];\n    var clipZs = [];\n    var ready = true;\n    for (var i = tiles.length - 1; i >= 0; --i) {\n      var tile = /** @type {import(\"../../VectorRenderTile.js\").default} */tiles[i];\n      ready = ready && !tile.getReplayState(layer).dirty;\n      var executorGroups = tile.executorGroups[getUid(layer)].filter(function (group) {\n        return group.hasExecutors(replayTypes);\n      });\n      if (executorGroups.length === 0) {\n        continue;\n      }\n      var transform = this.getTileRenderTransform(tile, frameState);\n      var currentZ = tile.tileCoord[0];\n      var contextSaved = false;\n      // Clip mask for regions in this tile that already filled by a higher z tile\n      var currentClip = executorGroups[0].getClipCoords(transform);\n      if (currentClip) {\n        for (var j = 0, jj = clips.length; j < jj; ++j) {\n          if (z !== currentZ && currentZ < clipZs[j]) {\n            var clip = clips[j];\n            if (intersects([currentClip[0], currentClip[3], currentClip[4], currentClip[7]], [clip[0], clip[3], clip[4], clip[7]])) {\n              if (!contextSaved) {\n                context.save();\n                contextSaved = true;\n              }\n              context.beginPath();\n              // counter-clockwise (outer ring) for current tile\n              context.moveTo(currentClip[0], currentClip[1]);\n              context.lineTo(currentClip[2], currentClip[3]);\n              context.lineTo(currentClip[4], currentClip[5]);\n              context.lineTo(currentClip[6], currentClip[7]);\n              // clockwise (inner ring) for higher z tile\n              context.moveTo(clip[6], clip[7]);\n              context.lineTo(clip[4], clip[5]);\n              context.lineTo(clip[2], clip[3]);\n              context.lineTo(clip[0], clip[1]);\n              context.clip();\n            }\n          }\n        }\n        clips.push(currentClip);\n        clipZs.push(currentZ);\n      }\n      for (var t = 0, tt = executorGroups.length; t < tt; ++t) {\n        var executorGroup = executorGroups[t];\n        executorGroup.execute(context, 1, transform, rotation, hifi, replayTypes);\n      }\n      if (contextSaved) {\n        context.restore();\n      }\n    }\n    context.globalAlpha = alpha;\n    this.ready = ready;\n    return this.container;\n  };\n  /**\n   * @param {import(\"../../Feature.js\").FeatureLike} feature Feature.\n   * @param {number} squaredTolerance Squared tolerance.\n   * @param {import(\"../../style/Style.js\").default|Array<import(\"../../style/Style.js\").default>} styles The style or array of styles.\n   * @param {import(\"../../render/canvas/BuilderGroup.js\").default} builderGroup Replay group.\n   * @param {import(\"../../render/canvas/BuilderGroup.js\").default} [opt_declutterBuilderGroup] Builder group for decluttering.\n   * @return {boolean} `true` if an image is loading.\n   */\n  CanvasVectorTileLayerRenderer.prototype.renderFeature = function (feature, squaredTolerance, styles, builderGroup, opt_declutterBuilderGroup) {\n    if (!styles) {\n      return false;\n    }\n    var loading = false;\n    if (Array.isArray(styles)) {\n      for (var i = 0, ii = styles.length; i < ii; ++i) {\n        loading = renderFeature(builderGroup, feature, styles[i], squaredTolerance, this.boundHandleStyleImageChange_, undefined, opt_declutterBuilderGroup) || loading;\n      }\n    } else {\n      loading = renderFeature(builderGroup, feature, styles, squaredTolerance, this.boundHandleStyleImageChange_, undefined, opt_declutterBuilderGroup);\n    }\n    return loading;\n  };\n  /**\n   * @param {import(\"../../VectorRenderTile.js\").default} tile Tile.\n   * @return {boolean} A new tile image was rendered.\n   * @private\n   */\n  CanvasVectorTileLayerRenderer.prototype.tileImageNeedsRender_ = function (tile) {\n    var layer = /** @type {import(\"../../layer/VectorTile.js\").default} */this.getLayer();\n    if (layer.getRenderMode() === VectorTileRenderType.VECTOR) {\n      return false;\n    }\n    var replayState = tile.getReplayState(layer);\n    var revision = layer.getRevision();\n    var resolution = tile.wantedResolution;\n    return replayState.renderedTileResolution !== resolution || replayState.renderedTileRevision !== revision;\n  };\n  /**\n   * @param {import(\"../../VectorRenderTile.js\").default} tile Tile.\n   * @param {import(\"../../PluggableMap\").FrameState} frameState Frame state.\n   * @private\n   */\n  CanvasVectorTileLayerRenderer.prototype.renderTileImage_ = function (tile, frameState) {\n    var layer = /** @type {import(\"../../layer/VectorTile.js\").default} */this.getLayer();\n    var replayState = tile.getReplayState(layer);\n    var revision = layer.getRevision();\n    var executorGroups = tile.executorGroups[getUid(layer)];\n    replayState.renderedTileRevision = revision;\n    var tileCoord = tile.wrappedTileCoord;\n    var z = tileCoord[0];\n    var source = layer.getSource();\n    var pixelRatio = frameState.pixelRatio;\n    var viewState = frameState.viewState;\n    var projection = viewState.projection;\n    var tileGrid = source.getTileGridForProjection(projection);\n    var tileResolution = tileGrid.getResolution(tile.tileCoord[0]);\n    var renderPixelRatio = frameState.pixelRatio / tile.wantedResolution * tileResolution;\n    var resolution = tileGrid.getResolution(z);\n    var context = tile.getContext(layer);\n    // Increase tile size when overzooming for low pixel ratio, to avoid blurry tiles\n    pixelRatio = Math.round(Math.max(pixelRatio, renderPixelRatio / pixelRatio));\n    var size = source.getTilePixelSize(z, pixelRatio, projection);\n    context.canvas.width = size[0];\n    context.canvas.height = size[1];\n    var renderScale = pixelRatio / renderPixelRatio;\n    if (renderScale !== 1) {\n      var canvasTransform = resetTransform(this.tmpTransform_);\n      scaleTransform(canvasTransform, renderScale, renderScale);\n      context.setTransform.apply(context, canvasTransform);\n    }\n    var tileExtent = tileGrid.getTileCoordExtent(tileCoord, this.tmpExtent);\n    var pixelScale = renderPixelRatio / resolution;\n    var transform = resetTransform(this.tmpTransform_);\n    scaleTransform(transform, pixelScale, -pixelScale);\n    translateTransform(transform, -tileExtent[0], -tileExtent[3]);\n    for (var i = 0, ii = executorGroups.length; i < ii; ++i) {\n      var executorGroup = executorGroups[i];\n      executorGroup.execute(context, renderScale, transform, 0, true, IMAGE_REPLAYS[layer.getRenderMode()]);\n    }\n    replayState.renderedTileResolution = tile.wantedResolution;\n  };\n  return CanvasVectorTileLayerRenderer;\n}(CanvasTileLayerRenderer);\nexport default CanvasVectorTileLayerRenderer;","map":{"version":3,"names":["CanvasBuilderGroup","CanvasExecutorGroup","CanvasTileLayerRenderer","TileState","VectorTileRenderType","ViewHint","HIT_DETECT_RESOLUTION","createHitDetectionImageData","hitDetect","apply","applyTransform","create","createTransform","multiply","reset","resetTransform","scale","scaleTransform","translate","translateTransform","boundingExtent","buffer","containsExtent","equals","getIntersection","getTopLeft","intersects","getSquaredTolerance","getSquaredRenderTolerance","renderFeature","getUid","toSize","wrapX","IMAGE_REPLAYS","VECTOR_REPLAYS","CanvasVectorTileLayerRenderer","_super","__extends","layer","_this","call","boundHandleStyleImageChange_","handleStyleImageChange_","bind","renderedLayerRevision_","renderedPixelToCoordinateTransform_","renderedRotation_","tmpTransform_","prototype","prepareTile","tile","pixelRatio","projection","render","state","getState","LOADED","ERROR","updateExecutorGroup_","tileImageNeedsRender_","getTile","z","x","y","frameState","viewState","resolution","getLayer","getSource","viewHints","hifi","ANIMATING","INTERACTING","wantedResolution","Date","now","time","getRenderMode","VECTOR","renderTileImage_","isDrawableTile","executorGroups","hasContext","getTileImage","getImage","prepareFrame","layerRevision","getRevision","renderedTiles","length","revision","renderOrder","getRenderOrder","builderState","getReplayState","dirty","renderedResolution","renderedRevision","renderedRenderOrder","source","declutter","getDeclutter","sourceTileGrid","getTileGrid","tileGrid","getTileGridForProjection","tileExtent","getTileCoordExtent","wrappedTileCoord","sourceTiles","getSourceTiles","layerUid","hitDetectionImageData","declutterExecutorGroups","t","tt","sourceTile","sourceTileCoord","tileCoord","sourceTileExtent","sharedExtent","builderExtent","getRenderBuffer","this_1","tmpExtent","bufferedExtent","builderGroup","declutterBuilderGroup","undefined","squaredTolerance","feature","styles","styleFunction","getStyleFunction","features","getFeatures","sort","i","ii","getGeometry","getExtent","executorGroupInstructions","finish","replayExtent","renderingReplayGroup","getOverlaps","push","declutterExecutorGroup","forEachFeatureAtCoordinate","coordinate","hitTolerance","callback","matches","rotation","hitExtent","featureCallback","geometry","distanceSq","key","getId","match","splice","lastIndexOf","found","some","declutteredFeatures","declutterTree","all","map","item","value","executorGroup","pixel","Promise","resolve","reject","renderedProjection","projectionExtent","slice","getTileCoordForCoordAndResolution","toString","extent_1","getWrapX","canWrapX","loadingSourceTiles","extent","corner","tilePixel","reduce","accumulator","concat","animatingOrInteracting_","tileSize","getTileSize","getZForResolution","zDirection","transforms","getRenderTransform","getTileCoordCenter","handleFontsChanged","getVisible","changed","event","renderIfReadyAndVisible","renderDeclutter","context","alpha","globalAlpha","getOpacity","tiles","j","execute","getTileRenderTransform","center","size","width","Math","round","height","worldOffset","transform","inversePixelTransform","renderFrame","target","pixelToCoordinateTransform","renderMode","replayTypes","tileSource","clips","clipZs","ready","filter","group","hasExecutors","currentZ","contextSaved","currentClip","getClipCoords","jj","clip","save","beginPath","moveTo","lineTo","restore","container","opt_declutterBuilderGroup","loading","Array","isArray","replayState","renderedTileResolution","renderedTileRevision","tileResolution","getResolution","renderPixelRatio","getContext","max","getTilePixelSize","canvas","renderScale","canvasTransform","setTransform","pixelScale"],"sources":["../../src/renderer/canvas/VectorTileLayer.js"],"sourcesContent":[null],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}