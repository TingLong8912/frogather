{"ast":null,"code":"/**\n * @module ol/format/IIIFInfo\n */\nvar __spreadArray = this && this.__spreadArray || function (to, from, pack) {\n  if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n    if (ar || !(i in from)) {\n      if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n      ar[i] = from[i];\n    }\n  }\n  return to.concat(ar || Array.prototype.slice.call(from));\n};\nimport { assert } from '../asserts.js';\nimport { includes } from '../array.js';\n/**\n * @typedef {Object} PreferredOptions\n * @property {string} [format] Preferred image format. Will be used if the image information\n * indicates support for that format.\n * @property {string} [quality] IIIF image qualitiy.  Will be used if the image information\n * indicates support for that quality.\n */\n/**\n * @typedef {Object} SupportedFeatures\n * @property {Array<string>} [supports] Supported IIIF image size and region\n * calculation features.\n * @property {Array<string>} [formats] Supported image formats.\n * @property {Array<string>} [qualities] Supported IIIF image qualities.\n */\n/**\n * @typedef {Object} TileInfo\n * @property {Array<number>} scaleFactors Supported resolution scaling factors.\n * @property {number} width Tile width in pixels.\n * @property {number} [height] Tile height in pixels. Same as tile width if height is\n * not given.\n */\n/**\n * @typedef {Object} IiifProfile\n * @property {Array<string>} [formats] Supported image formats for the image service.\n * @property {Array<string>} [qualities] Supported IIIF image qualities.\n * @property {Array<string>} [supports] Supported features.\n * @property {number} [maxArea] Maximum area (pixels) available for this image service.\n * @property {number} [maxHeight] Maximum height.\n * @property {number} [maxWidth] Maximum width.\n */\n/**\n * @typedef {Object<string,string|number|Array<number|string|IiifProfile|Object<string, number>|TileInfo>>}\n *    ImageInformationResponse\n */\n/**\n * Enum representing the major IIIF Image API versions\n * @enum {string}\n */\nexport var Versions = {\n  VERSION1: 'version1',\n  VERSION2: 'version2',\n  VERSION3: 'version3'\n};\n/**\n * Supported image formats, qualities and supported region / size calculation features\n * for different image API versions and compliance levels\n * @const\n * @type {Object<string, Object<string, SupportedFeatures>>}\n */\nvar IIIF_PROFILE_VALUES = {};\nIIIF_PROFILE_VALUES[Versions.VERSION1] = {\n  'level0': {\n    supports: [],\n    formats: [],\n    qualities: ['native']\n  },\n  'level1': {\n    supports: ['regionByPx', 'sizeByW', 'sizeByH', 'sizeByPct'],\n    formats: ['jpg'],\n    qualities: ['native']\n  },\n  'level2': {\n    supports: ['regionByPx', 'regionByPct', 'sizeByW', 'sizeByH', 'sizeByPct', 'sizeByConfinedWh', 'sizeByWh'],\n    formats: ['jpg', 'png'],\n    qualities: ['native', 'color', 'grey', 'bitonal']\n  }\n};\nIIIF_PROFILE_VALUES[Versions.VERSION2] = {\n  'level0': {\n    supports: [],\n    formats: ['jpg'],\n    qualities: ['default']\n  },\n  'level1': {\n    supports: ['regionByPx', 'sizeByW', 'sizeByH', 'sizeByPct'],\n    formats: ['jpg'],\n    qualities: ['default']\n  },\n  'level2': {\n    supports: ['regionByPx', 'regionByPct', 'sizeByW', 'sizeByH', 'sizeByPct', 'sizeByConfinedWh', 'sizeByDistortedWh', 'sizeByWh'],\n    formats: ['jpg', 'png'],\n    qualities: ['default', 'bitonal']\n  }\n};\nIIIF_PROFILE_VALUES[Versions.VERSION3] = {\n  'level0': {\n    supports: [],\n    formats: ['jpg'],\n    qualities: ['default']\n  },\n  'level1': {\n    supports: ['regionByPx', 'regionSquare', 'sizeByW', 'sizeByH', 'sizeByWh'],\n    formats: ['jpg'],\n    qualities: ['default']\n  },\n  'level2': {\n    supports: ['regionByPx', 'regionSquare', 'regionByPct', 'sizeByW', 'sizeByH', 'sizeByPct', 'sizeByConfinedWh', 'sizeByWh'],\n    formats: ['jpg', 'png'],\n    qualities: ['default']\n  }\n};\nIIIF_PROFILE_VALUES['none'] = {\n  'none': {\n    supports: [],\n    formats: [],\n    qualities: []\n  }\n};\nvar COMPLIANCE_VERSION1 = /^https?:\\/\\/library\\.stanford\\.edu\\/iiif\\/image-api\\/(?:1\\.1\\/)?compliance\\.html#level[0-2]$/;\nvar COMPLIANCE_VERSION2 = /^https?:\\/\\/iiif\\.io\\/api\\/image\\/2\\/level[0-2](?:\\.json)?$/;\nvar COMPLIANCE_VERSION3 = /(^https?:\\/\\/iiif\\.io\\/api\\/image\\/3\\/level[0-2](?:\\.json)?$)|(^level[0-2]$)/;\nfunction generateVersion1Options(iiifInfo) {\n  var levelProfile = iiifInfo.getComplianceLevelSupportedFeatures();\n  // Version 1.0 and 1.1 do not require a profile.\n  if (levelProfile === undefined) {\n    levelProfile = IIIF_PROFILE_VALUES[Versions.VERSION1]['level0'];\n  }\n  return {\n    url: iiifInfo.imageInfo['@id'] === undefined ? undefined : iiifInfo.imageInfo['@id'].replace(/\\/?(?:info\\.json)?$/g, ''),\n    supports: levelProfile.supports,\n    formats: __spreadArray(__spreadArray([], levelProfile.formats, true), [iiifInfo.imageInfo.formats === undefined ? [] : iiifInfo.imageInfo.formats], false),\n    qualities: __spreadArray(__spreadArray([], levelProfile.qualities, true), [iiifInfo.imageInfo.qualities === undefined ? [] : iiifInfo.imageInfo.qualities], false),\n    resolutions: iiifInfo.imageInfo.scale_factors,\n    tileSize: iiifInfo.imageInfo.tile_width !== undefined ? iiifInfo.imageInfo.tile_height !== undefined ? [iiifInfo.imageInfo.tile_width, iiifInfo.imageInfo.tile_height] : [iiifInfo.imageInfo.tile_width, iiifInfo.imageInfo.tile_width] : iiifInfo.imageInfo.tile_height != undefined ? [iiifInfo.imageInfo.tile_height, iiifInfo.imageInfo.tile_height] : undefined\n  };\n}\nfunction generateVersion2Options(iiifInfo) {\n  var levelProfile = iiifInfo.getComplianceLevelSupportedFeatures(),\n    additionalProfile = Array.isArray(iiifInfo.imageInfo.profile) && iiifInfo.imageInfo.profile.length > 1,\n    profileSupports = additionalProfile && iiifInfo.imageInfo.profile[1].supports ? iiifInfo.imageInfo.profile[1].supports : [],\n    profileFormats = additionalProfile && iiifInfo.imageInfo.profile[1].formats ? iiifInfo.imageInfo.profile[1].formats : [],\n    profileQualities = additionalProfile && iiifInfo.imageInfo.profile[1].qualities ? iiifInfo.imageInfo.profile[1].qualities : [];\n  return {\n    url: iiifInfo.imageInfo['@id'].replace(/\\/?(?:info\\.json)?$/g, ''),\n    sizes: iiifInfo.imageInfo.sizes === undefined ? undefined : iiifInfo.imageInfo.sizes.map(function (size) {\n      return [size.width, size.height];\n    }),\n    tileSize: iiifInfo.imageInfo.tiles === undefined ? undefined : [iiifInfo.imageInfo.tiles.map(function (tile) {\n      return tile.width;\n    })[0], iiifInfo.imageInfo.tiles.map(function (tile) {\n      return tile.height === undefined ? tile.width : tile.height;\n    })[0]],\n    resolutions: iiifInfo.imageInfo.tiles === undefined ? undefined : iiifInfo.imageInfo.tiles.map(function (tile) {\n      return tile.scaleFactors;\n    })[0],\n    supports: __spreadArray(__spreadArray([], levelProfile.supports, true), profileSupports, true),\n    formats: __spreadArray(__spreadArray([], levelProfile.formats, true), profileFormats, true),\n    qualities: __spreadArray(__spreadArray([], levelProfile.qualities, true), profileQualities, true)\n  };\n}\nfunction generateVersion3Options(iiifInfo) {\n  var levelProfile = iiifInfo.getComplianceLevelSupportedFeatures(),\n    formats = iiifInfo.imageInfo.extraFormats === undefined ? levelProfile.formats : __spreadArray(__spreadArray([], levelProfile.formats, true), iiifInfo.imageInfo.extraFormats, true),\n    preferredFormat = iiifInfo.imageInfo.preferredFormats !== undefined && Array.isArray(iiifInfo.imageInfo.preferredFormats) && iiifInfo.imageInfo.preferredFormats.length > 0 ? iiifInfo.imageInfo.preferredFormats.filter(function (format) {\n      return includes(['jpg', 'png', 'gif'], format);\n    }).reduce(function (acc, format) {\n      return acc === undefined && includes(formats, format) ? format : acc;\n    }, undefined) : undefined;\n  return {\n    url: iiifInfo.imageInfo['id'],\n    sizes: iiifInfo.imageInfo.sizes === undefined ? undefined : iiifInfo.imageInfo.sizes.map(function (size) {\n      return [size.width, size.height];\n    }),\n    tileSize: iiifInfo.imageInfo.tiles === undefined ? undefined : [iiifInfo.imageInfo.tiles.map(function (tile) {\n      return tile.width;\n    })[0], iiifInfo.imageInfo.tiles.map(function (tile) {\n      return tile.height;\n    })[0]],\n    resolutions: iiifInfo.imageInfo.tiles === undefined ? undefined : iiifInfo.imageInfo.tiles.map(function (tile) {\n      return tile.scaleFactors;\n    })[0],\n    supports: iiifInfo.imageInfo.extraFeatures === undefined ? levelProfile.supports : __spreadArray(__spreadArray([], levelProfile.supports, true), iiifInfo.imageInfo.extraFeatures, true),\n    formats: formats,\n    qualities: iiifInfo.imageInfo.extraQualities === undefined ? levelProfile.qualities : __spreadArray(__spreadArray([], levelProfile.qualities, true), iiifInfo.imageInfo.extraQualities, true),\n    preferredFormat: preferredFormat\n  };\n}\nvar versionFunctions = {};\nversionFunctions[Versions.VERSION1] = generateVersion1Options;\nversionFunctions[Versions.VERSION2] = generateVersion2Options;\nversionFunctions[Versions.VERSION3] = generateVersion3Options;\n/**\n * @classdesc\n * Format for transforming IIIF Image API image information responses into\n * IIIF tile source ready options\n *\n * @api\n */\nvar IIIFInfo = /** @class */function () {\n  /**\n   * @param {string|ImageInformationResponse} imageInfo\n   * Deserialized image information JSON response object or JSON response as string\n   */\n  function IIIFInfo(imageInfo) {\n    this.setImageInfo(imageInfo);\n  }\n  /**\n   * @param {string|ImageInformationResponse} imageInfo\n   * Deserialized image information JSON response object or JSON response as string\n   * @api\n   */\n  IIIFInfo.prototype.setImageInfo = function (imageInfo) {\n    if (typeof imageInfo == 'string') {\n      this.imageInfo = JSON.parse(imageInfo);\n    } else {\n      this.imageInfo = imageInfo;\n    }\n  };\n  /**\n   * @return {Versions} Major IIIF version.\n   * @api\n   */\n  IIIFInfo.prototype.getImageApiVersion = function () {\n    if (this.imageInfo === undefined) {\n      return;\n    }\n    var context = this.imageInfo['@context'] || 'ol-no-context';\n    if (typeof context == 'string') {\n      context = [context];\n    }\n    for (var i = 0; i < context.length; i++) {\n      switch (context[i]) {\n        case 'http://library.stanford.edu/iiif/image-api/1.1/context.json':\n        case 'http://iiif.io/api/image/1/context.json':\n          return Versions.VERSION1;\n        case 'http://iiif.io/api/image/2/context.json':\n          return Versions.VERSION2;\n        case 'http://iiif.io/api/image/3/context.json':\n          return Versions.VERSION3;\n        case 'ol-no-context':\n          // Image API 1.0 has no '@context'\n          if (this.getComplianceLevelEntryFromProfile(Versions.VERSION1) && this.imageInfo.identifier) {\n            return Versions.VERSION1;\n          }\n          break;\n        default:\n      }\n    }\n    assert(false, 61);\n  };\n  /**\n   * @param {Versions} version Optional IIIF image API version\n   * @return {string} Compliance level as it appears in the IIIF image information\n   * response.\n   */\n  IIIFInfo.prototype.getComplianceLevelEntryFromProfile = function (version) {\n    if (this.imageInfo === undefined || this.imageInfo.profile === undefined) {\n      return;\n    }\n    if (version === undefined) {\n      version = this.getImageApiVersion();\n    }\n    switch (version) {\n      case Versions.VERSION1:\n        if (COMPLIANCE_VERSION1.test(this.imageInfo.profile)) {\n          return this.imageInfo.profile;\n        }\n        break;\n      case Versions.VERSION3:\n        if (COMPLIANCE_VERSION3.test(this.imageInfo.profile)) {\n          return this.imageInfo.profile;\n        }\n        break;\n      case Versions.VERSION2:\n        if (typeof this.imageInfo.profile === 'string' && COMPLIANCE_VERSION2.test(this.imageInfo.profile)) {\n          return this.imageInfo.profile;\n        }\n        if (Array.isArray(this.imageInfo.profile) && this.imageInfo.profile.length > 0 && typeof this.imageInfo.profile[0] === 'string' && COMPLIANCE_VERSION2.test(this.imageInfo.profile[0])) {\n          return this.imageInfo.profile[0];\n        }\n        break;\n      default:\n    }\n  };\n  /**\n   * @param {Versions} version Optional IIIF image API version\n   * @return {string} Compliance level, on of 'level0', 'level1' or 'level2' or undefined\n   */\n  IIIFInfo.prototype.getComplianceLevelFromProfile = function (version) {\n    var complianceLevel = this.getComplianceLevelEntryFromProfile(version);\n    if (complianceLevel === undefined) {\n      return undefined;\n    }\n    var level = complianceLevel.match(/level[0-2](?:\\.json)?$/g);\n    return Array.isArray(level) ? level[0].replace('.json', '') : undefined;\n  };\n  /**\n   * @return {SupportedFeatures} Image formats, qualities and region / size calculation\n   * methods that are supported by the IIIF service.\n   */\n  IIIFInfo.prototype.getComplianceLevelSupportedFeatures = function () {\n    if (this.imageInfo === undefined) {\n      return;\n    }\n    var version = this.getImageApiVersion();\n    var level = this.getComplianceLevelFromProfile(version);\n    if (level === undefined) {\n      return IIIF_PROFILE_VALUES['none']['none'];\n    }\n    return IIIF_PROFILE_VALUES[version][level];\n  };\n  /**\n   * @param {PreferredOptions} [opt_preferredOptions] Optional options for preferred format and quality.\n   * @return {import(\"../source/IIIF.js\").Options} IIIF tile source ready constructor options.\n   * @api\n   */\n  IIIFInfo.prototype.getTileSourceOptions = function (opt_preferredOptions) {\n    var options = opt_preferredOptions || {},\n      version = this.getImageApiVersion();\n    if (version === undefined) {\n      return;\n    }\n    var imageOptions = version === undefined ? undefined : versionFunctions[version](this);\n    if (imageOptions === undefined) {\n      return;\n    }\n    return {\n      url: imageOptions.url,\n      version: version,\n      size: [this.imageInfo.width, this.imageInfo.height],\n      sizes: imageOptions.sizes,\n      format: options.format !== undefined && includes(imageOptions.formats, options.format) ? options.format : imageOptions.preferredFormat !== undefined ? imageOptions.preferredFormat : 'jpg',\n      supports: imageOptions.supports,\n      quality: options.quality && includes(imageOptions.qualities, options.quality) ? options.quality : includes(imageOptions.qualities, 'native') ? 'native' : 'default',\n      resolutions: Array.isArray(imageOptions.resolutions) ? imageOptions.resolutions.sort(function (a, b) {\n        return b - a;\n      }) : undefined,\n      tileSize: imageOptions.tileSize\n    };\n  };\n  return IIIFInfo;\n}();\nexport default IIIFInfo;","map":{"version":3,"names":["assert","includes","Versions","VERSION1","VERSION2","VERSION3","IIIF_PROFILE_VALUES","supports","formats","qualities","COMPLIANCE_VERSION1","COMPLIANCE_VERSION2","COMPLIANCE_VERSION3","generateVersion1Options","iiifInfo","levelProfile","getComplianceLevelSupportedFeatures","undefined","url","imageInfo","replace","__spreadArray","resolutions","scale_factors","tileSize","tile_width","tile_height","generateVersion2Options","additionalProfile","Array","isArray","profile","length","profileSupports","profileFormats","profileQualities","sizes","map","size","width","height","tiles","tile","scaleFactors","generateVersion3Options","extraFormats","preferredFormat","preferredFormats","filter","format","reduce","acc","extraFeatures","extraQualities","versionFunctions","IIIFInfo","setImageInfo","prototype","JSON","parse","getImageApiVersion","context","i","getComplianceLevelEntryFromProfile","identifier","version","test","getComplianceLevelFromProfile","complianceLevel","level","match","getTileSourceOptions","opt_preferredOptions","options","imageOptions","quality","sort","a","b"],"sources":["../src/format/IIIFInfo.js"],"sourcesContent":[null],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}