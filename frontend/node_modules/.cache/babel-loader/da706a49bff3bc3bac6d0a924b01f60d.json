{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n    };\n    return extendStatics(d, b);\n  };\n  return function (d, b) {\n    if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n    extendStatics(d, b);\n    function __() {\n      this.constructor = d;\n    }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n/**\n * @module ol/net\n */\nimport { getUid } from './util.js';\n/**\n * Simple JSONP helper. Supports error callbacks and a custom callback param.\n * The error callback will be called when no JSONP is executed after 10 seconds.\n *\n * @param {string} url Request url. A 'callback' query parameter will be\n *     appended.\n * @param {Function} callback Callback on success.\n * @param {Function} [opt_errback] Callback on error.\n * @param {string} [opt_callbackParam] Custom query parameter for the JSONP\n *     callback. Default is 'callback'.\n */\nexport function jsonp(url, callback, opt_errback, opt_callbackParam) {\n  var script = document.createElement('script');\n  var key = 'olc_' + getUid(callback);\n  function cleanup() {\n    delete window[key];\n    script.parentNode.removeChild(script);\n  }\n  script.async = true;\n  script.src = url + (url.indexOf('?') == -1 ? '?' : '&') + (opt_callbackParam || 'callback') + '=' + key;\n  var timer = setTimeout(function () {\n    cleanup();\n    if (opt_errback) {\n      opt_errback();\n    }\n  }, 10000);\n  window[key] = function (data) {\n    clearTimeout(timer);\n    cleanup();\n    callback(data);\n  };\n  document.head.appendChild(script);\n}\nvar ResponseError = /** @class */function (_super) {\n  __extends(ResponseError, _super);\n  /**\n   * @param {XMLHttpRequest} response The XHR object.\n   */\n  function ResponseError(response) {\n    var _this = this;\n    var message = 'Unexpected response status: ' + response.status;\n    _this = _super.call(this, message) || this;\n    /**\n     * @type {string}\n     */\n    _this.name = 'ResponseError';\n    /**\n     * @type {XMLHttpRequest}\n     */\n    _this.response = response;\n    return _this;\n  }\n  return ResponseError;\n}(Error);\nexport { ResponseError };\nvar ClientError = /** @class */function (_super) {\n  __extends(ClientError, _super);\n  /**\n   * @param {XMLHttpRequest} client The XHR object.\n   */\n  function ClientError(client) {\n    var _this = _super.call(this, 'Failed to issue request') || this;\n    /**\n     * @type {string}\n     */\n    _this.name = 'ClientError';\n    /**\n     * @type {XMLHttpRequest}\n     */\n    _this.client = client;\n    return _this;\n  }\n  return ClientError;\n}(Error);\nexport { ClientError };\n/**\n * @param {string} url The URL.\n * @return {Promise<Object>} A promise that resolves to the JSON response.\n */\nexport function getJSON(url) {\n  return new Promise(function (resolve, reject) {\n    /**\n     * @param {ProgressEvent<XMLHttpRequest>} event The load event.\n     */\n    function onLoad(event) {\n      var client = event.target;\n      // status will be 0 for file:// urls\n      if (!client.status || client.status >= 200 && client.status < 300) {\n        var data = void 0;\n        try {\n          data = JSON.parse(client.responseText);\n        } catch (err) {\n          var message = 'Error parsing response text as JSON: ' + err.message;\n          reject(new Error(message));\n          return;\n        }\n        resolve(data);\n        return;\n      }\n      reject(new ResponseError(client));\n    }\n    /**\n     * @param {ProgressEvent<XMLHttpRequest>} event The error event.\n     */\n    function onError(event) {\n      reject(new ClientError(event.target));\n    }\n    var client = new XMLHttpRequest();\n    client.addEventListener('load', onLoad);\n    client.addEventListener('error', onError);\n    client.open('GET', url);\n    client.setRequestHeader('Accept', 'application/json');\n    client.send();\n  });\n}\n/**\n * @param {string} base The base URL.\n * @param {string} url The potentially relative URL.\n * @return {string} The full URL.\n */\nexport function resolveUrl(base, url) {\n  if (url.indexOf('://') >= 0) {\n    return url;\n  }\n  return new URL(url, base).href;\n}\nvar originalXHR;\nexport function overrideXHR(xhr) {\n  if (typeof XMLHttpRequest !== 'undefined') {\n    originalXHR = XMLHttpRequest;\n  }\n  global.XMLHttpRequest = xhr;\n}\nexport function restoreXHR() {\n  global.XMLHttpRequest = originalXHR;\n}","map":{"version":3,"names":["getUid","jsonp","url","callback","opt_errback","opt_callbackParam","script","document","createElement","key","cleanup","window","parentNode","removeChild","async","src","indexOf","timer","setTimeout","data","clearTimeout","head","appendChild","ResponseError","_super","__extends","response","_this","message","status","call","name","Error","ClientError","client","getJSON","Promise","resolve","reject","onLoad","event","target","JSON","parse","responseText","err","onError","XMLHttpRequest","addEventListener","open","setRequestHeader","send","resolveUrl","base","URL","href","originalXHR","overrideXHR","xhr","global","restoreXHR"],"sources":["src/net.js"],"sourcesContent":[null],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}